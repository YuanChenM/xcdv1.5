<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//ibatis.apache.org//DTD Mapper 3.0//EN" "http://ibatis.apache.org/dtd/ibatis-3-mapper.dtd">
<mapper namespace="com.msk.seller.logic.SL24110102Logic">
    <insert id="saveHis" parameterType="com.msk.core.entity.SlSellerHis">
        INSERT INTO SL_SELLER_HIS
        (
        HIS_ID,
        SL_ACCOUNT,
        AREA_CODE,
        SL_CODE,
        SL_CODE_DIS,
        LGCS_AREA_CODE,
        PROVINCE_CODE,
        CITY_CODE,
        DISTRICT_CODE,
        SL_CON_FLG,
        EP_ID,
        SL_MAIN_CLASS,
        SNK_FLG,
        SELF_FLG,
        AGENT_FLG,
        OEM_FLG,
        SQA_STATUS,
        CRT_ID,
        CRT_TIME,
        UPD_ID,
        UPD_TIME,
        ACT_ID,
        ACT_TIME,
        DEL_FLG,
        VER,
        MEMO1,
        MEMO2,
        MEMO3,
        MEMO4,
        MEMO5,
        MEMO6,
        MEMO7,
        MEMO8,
        MEMO9,
        MEMO10,
        MEMO11,
        MEMO12,
        MEMO13,
        MEMO14,
        MEMO15,
        MEMO16,
        MEMO17,
        MEMO18,
        MEMO19,
        MEMO20
        )
        VALUES (
        #{hisId},
        #{slAccount},
        #{areaCode},
        #{slCode},
        #{slCodeDis},
        #{lgcsAreaCode},
        #{provinceCode},
        #{cityCode},
        #{districtCode},
        #{slConFlg},
        #{epId},
        #{slMainClass},
        #{snkFlg},
        #{selfFlg},
        #{agentFlg},
        #{oemFlg},
        #{sqaStatus},
        #{crtId},
        #{crtTime},
        #{crtId},
        #{crtTime},
        #{crtId},
        #{crtTime},
        0,
        1,
        #{memo1},
        #{memo2},
        #{memo3},
        #{memo4},
        #{memo5},
        #{memo6},
        #{memo7},
        #{memo8},
        #{memo9},
        #{memo10},
        #{memo11},
        #{memo12},
        #{memo13},
        #{memo14},
        #{memo15},
        #{memo16},
        #{memo17},
        #{memo18},
        #{memo19},
        #{memo20}
        )
    </insert>
    <select id="findSlSellerBySlCode" parameterType="BaseParam" resultType="com.msk.core.entity.SlSellerHis">
        SELECT
        SL_CODE AS slCode,
        SL_ACCOUNT AS slAccount,
        SL_CODE_DIS AS slCodeDis,
        SL_CON_FLG AS slConFlg,
        AREA_CODE AS areaCode,
        LGCS_AREA_CODE AS lgcsAreaCode,
        PROVINCE_CODE AS provinceCode,
        CITY_CODE AS cityCode,
        DISTRICT_CODE AS districtCode,
        EP_ID AS epId,
        SL_MAIN_CLASS AS slMainClass,
        SNK_FLG AS snkFlg,
        SELF_FLG AS selfFlg,
        AGENT_FLG AS agentFlg,
        OEM_FLG AS oemFlg,
        BUYER_FLG AS buyerFlg,
        SQA_STATUS AS sqaStatus,
        DIST_QUA AS distQua,
        SHOP_QUA AS  shopQua,
        MEMO1 AS memo1,
        MEMO2 AS memo2,
        MEMO3 AS memo3,
        MEMO4 AS memo4,
        MEMO5 AS memo5,
        MEMO6 AS memo6,
        MEMO7 AS memo7,
        MEMO8 AS memo8,
        MEMO9 AS memo9,
        MEMO10 AS memo10,
        MEMO11 AS memo11,
        MEMO12 AS memo12,
        MEMO13 AS memo13,
        MEMO14 AS memo14,
        MEMO15 AS memo15,
        MEMO16 AS memo16,
        MEMO17 AS memo17,
        MEMO18 AS memo18,
        MEMO19 AS memo19,
        MEMO20 AS memo20,
        DEL_FLG AS delFlg,
        CRT_ID AS crtId,
        CRT_TIME AS crtTime,
        UPD_ID AS updId,
        UPD_TIME AS updTime,
        ACT_ID AS actId,
        ACT_TIME AS actTime,
        VER AS ver
        FROM SL_SELLER
        WHERE SL_CODE=#{filterMap.slCode}
        AND  DEL_FLG = 0
    </select>
    <update id="modifyEp" parameterType="com.msk.core.entity.SlEnterprise">
        UPDATE sl_enterprise
            SET LIC_NO = #{licNo},
            EP_NAME = #{epName},
            LIC_ADDR = #{licAddr},
            LIC_BUSI_TYPE = #{licBusiType},
            LIC_BUSI_SCOPE = #{licBusiScope},
            LIC_LEGAL_PERSON = #{licLegalPerson},
            LIC_REG_CAPITAL = #{licRegCapital},
            LIC_PAIDIN_CAPITAL = #{licPaidinCapital},
            LIC_CRT_DATE = #{licCrtDate},
            LIC_TERM_BEGIN = #{licTermBegin},
            LIC_TERM_END = #{licTermEnd},
            TAX_NO = #{taxNo},
            TAX_VAT_NO = #{taxVatNo},
            ORG_NO = #{orgNo},
            BAL_LEGAL_PERSON = #{balLegalPerson},
            BAL_BANK = #{balBank},
            BAL_ACCOUNT = #{balAccount},
           	LIC_TERM_UNLIIMITED = #{licTermUnliimited},
            ORG_TERM_BEGIN = #{orgTermBegin},
            ORG_TERM_END = #{orgTermEnd},
            FDL_NO = #{fdlNo},
            FDL_TERM_BEGIN = #{fdlTermBegin},
            FDL_TERM_END = #{fdlTermEnd},
            UPD_ID = #{updId},
            UPD_TIME=#{updTime},
            LIC_TYPE = #{licType},
            LIC_NAME = #{licName},
            VER = VER+1
            WHERE
	        EP_ID = #{epId}

    </update>
    <update id="modifySl" parameterType="com.msk.core.entity.SlSeller">
        UPDATE sl_seller SET
        <if test="slCodeDis!=null and slCodeDis!=''">
            SL_CODE_DIS=#{slCodeDis},
        </if>
        SL_CON_FLG =#{slConFlg},

        AREA_CODE =#{areaCode},
        LGCS_AREA_CODE=#{lgcsAreaCode},
        PROVINCE_CODE=#{provinceCode},
        CITY_CODE=#{cityCode},
        DISTRICT_CODE=#{districtCode},

        AREA_NAME =#{areaName},
        LGCS_AREA_NAME =#{lgcsAreaName},
        PROVINCE_NAME =#{provinceName},
        CITY_NAME =#{cityName},
        DISTRICT_NAME = #{districtName},

        SL_MAIN_CLASS=#{slMainClass},
        SELF_FLG=#{selfFlg},
        AGENT_FLG=#{agentFlg},
        OEM_FLG=#{oemFlg},
        SNK_FLG=#{snkFlg},
        BUYER_FLG=#{buyerFlg},
        SQA_STATUS=#{sqaStatus},
        DIST_QUA=#{distQua},
        SHOP_QUA=#{shopQua},
        MEMO1=#{memo1},
        MEMO2=#{memo2},
        MEMO3=#{memo3},
        MEMO4=#{memo4},
        MEMO5=#{memo5},
        MEMO6=#{memo6},
        MEMO7=#{memo7},
        MEMO8=#{memo8},
        MEMO9=#{memo9},
        MEMO10=#{memo10},
        MEMO11=#{memo11},
        MEMO12=#{memo12},
        MEMO13=#{memo13},
        MEMO14=#{memo14},
        MEMO15=#{memo15},
        MEMO16=#{memo16},
        MEMO17=#{memo17},
        MEMO18=#{memo18},
        MEMO19=#{memo19},
        MEMO20=#{memo20},
        UPD_ID=#{updId},
        UPD_TIME=#{updTime},
        VER= VER + 1
        WHERE
        sl_account=#{slAccount}
    </update>

    <select id="queryMax" resultType="com.msk.core.entity.SlSeller" parameterType="BaseParam">
        SELECT
        CONCAT('${filterMap.slMainClass}','${filterMap.cityCode}',LPAD(MAX(CAST(RIGHT(SL_CODE_DIS,3) AS SIGNED))+1,3,0)) AS slCodeDis
        FROM sl_seller
        WHERE SL_MAIN_CLASS = #{filterMap.slMainClass}
        AND CITY_CODE = #{filterMap.cityCode}
        AND  DEL_FLG = 0
        AND SL_CON_FLG=#{filterMap.slConFlg}
    </select>
</mapper>